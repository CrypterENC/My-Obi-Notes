
[[WireShark]]

#WireShark-filters
## 1. What is WireShark Filters ? 

-  **Filters** are rules that let you control what packets you see or capture, helping you focus on the traffic relevant to your analysis. There are two main types:

	1.  **Capture Filters** – Applied _before_ capturing packets, these limit what Wireshark records from the network. For example : 

		-  `tcp port 80` : **now this will only capture HTTP traffic.**

	2.  **Display Filters** – Applied _after_ capturing, these let you narrow down what’s shown in the packet list without altering the capture file. For example :

		-  `ip.src == 192.168.1.10 && tcp` :  **now this will shows only TCP packets from that IP.**


	3.  To use this filter's (Capture and Display) `-->`  Click on Capture View and bottom part it will be mentioned : `Enter a capture filter`

		![[Pasted image 20250808214349.png]]

	-  **Important Note : KEEP THE FILTERS SIMPLE**


## 2. Top Wireshark Display Filters you need to know : 


1. **Common Filters :** 

	**🔹 By Protocol**
	
	- `http` → Show only HTTP traffic
	- `dns` → Show only DNS queries/responses
	- `icmp` → Show only ICMP (ping) packets
	- `tcp` / `udp` → Show only TCP or UDP
	
	**🔹 By IP Address**
	
	- `ip.addr == 192.168.1.10` → Any packet with this IP as source or destination
	- `ip.src == 192.168.1.10` → Packets sent _from_ that IP
	- `ip.dst == 192.168.1.10` → Packets sent _to_ that IP
	
	**🔹 By Port**
	
	- `tcp.port == 80` → Any TCP traffic on port 80 (HTTP)
	- `udp.port == 53` → Any UDP traffic on port 53 (DNS)
	- `tcp.dstport == 443` → Packets going to HTTPS
	
	**🔹 By Keywords**
	
	- `http.request` → Show only HTTP requests
	- `dns.qry.name == "example.com"` → DNS query for a specific domain

2.  **Operators used in filters**

	 -  **Basic Comparison Operators**

| Operator | Meaning          | Example                  |
| -------- | ---------------- | ------------------------ |
| `==`     | Equal to         | `ip.src == 192.168.1.10` |
| `!=`     | Not equal to     | `tcp.port != 80`         |
| `>`      | Greater than     | `frame.len > 500`        |
| `<`      | Less than        | `tcp.port < 1024`        |
| `>=`     | Greater or equal | `frame.len >= 1500`      |
| `<=`     | Less or equal    | `frame.len <= 64`        |

---

-  **Logical Operators**

| Operator | Meaning                 | Example                      |
| -------- | ----------------------- | ---------------------------- |
| `&&`     | AND (both must be true) | `ip.src == 10.0.0.5 && tcp`  |
| `!`      | NOT (negate)            | `!arp` (exclude ARP packets) |

---

- **Special / Pattern-Matching Operators**

|Operator|Meaning|Example|
|---|---|---|
|`contains`|Field contains a substring|`http.host contains "example"`|
|`matches`|Field matches a regex|`http.host matches ".*\.evil\.com"`|
|`in`|Value is in a set|`tcp.port in {80 443 8080}`|

---

**Tip:**

- `contains` is _faster_ than regex (`matches`)—use regex only when necessary.
- `in` is _gold_ for catching multiple ports, IPs, or protocols in one clean filter.
- Wrap complex logic in parentheses so you don’t get tripped up by operator precedence.


3.  **Some Combo's :**

	**🔹 Host & Protocol Combos**
	
	- `ip.addr == 10.0.0.5 && http` → HTTP traffic to/from a specific host
	- `ip.src == 192.168.1.100 && tcp.port == 22` → SSH sessions from a specific IP
	
	**🔹 Authentication Hunting**
	
	- `http.authbasic` → Basic Auth credentials in HTTP headers
	- `ftp.request.command == "USER"` → FTP login attempts
	- `smtp.req.command == "AUTH"` → SMTP authentication attempts
	
	**🔹 Credential Leaks / Cleartext**
	
	- `tcp.port == 21 || tcp.port == 23 || tcp.port == 110` → FTP, Telnet, POP3 (common plaintext creds)
	- `frame contains "password"` → Packets with the word “password” in payload
	
	**🔹 Malware / Beacon Detection**
	
	- `dns.qry.name contains "xyz123"` → Suspicious domain lookups
	- `tcp.flags == 0x02` → SYN packets (possible scanning)
	- `tcp.flags.syn == 1 && tcp.flags.ack == 0` → SYN without ACK (half-open scan)
	
	**🔹 File Transfer Detection**
	
	- `http.request.uri contains ".exe"` → Download of Windows executables
	- `ftp-data` → File transfers over FTP
	
	**🔹 VoIP / Multimedia**
	
	- `rtp` → Real-time voice/video streams
	- `sip` → SIP call signaling

## 3. Filtering for IP Addresses : 

1.  Use `ip.addr == {ip_address}`

	- Drag the destination ip address into the filter box, and change the name from `ip.dst` `-->`  `ip.addr`.

2.  What if you want to listen to the conversation b/w two IP Addresses 

	- **Right click on a packet** `-->` **Conversation Filter** `-->` **IPv4**

	- `ip.addr eq [ip_1] and ip.addr eq [ip_2]`

3.  Hide a particular ip .

	-  `!ip.addr == {ip_address}`

## 4. Filtering for Ports and Conversations : 



## 5. Lab 2 - Creating Display Filters : 
